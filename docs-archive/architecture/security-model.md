## SPIKE Security Model

// TODO: read this and ensure its still consistent.

Here is a brief introduction to **SPIKE** security model.

### Authentication and Communication

* All inter-component communication is secured through [**SPIFFE** mTLS][spiffe].
* Components identify each other using their **SVID**s.
* Network-level security is provided by **SPIFFE** mTLS.

[spiffe]: https://spiffe.io/

### Trust Boundaries

The primary trust boundary is at the machine level. Once the machine is 
compromised, hardening **SPIKE** components will provide diminishing returns.
In that regard, both physical, and OS-level security are important.

For example, when the machine is compromised, an attacker with sufficient 
privileges can observe and control the memory of **SPIKE Nexus**, or 
**SPIKE Keeper**; they can inject their counterfeit workloads; they can modify 
**SPIRE** and create their own registration entries

It's also worth noticing that, since **SPIKE Keeper** backs ups the **root key**
in memory, if **SPIKE Keeper** is compromised, the machine can be considered 
compromised.

For containerized deployments, both **SPIKE Nexus** and **SPIKE Keeper** 
shall be hardened.

## Key Management

* The system assumes a long-lived, well-guarded, initial root key.
  * The root key will be periodically rotated, but still, it will be long-lived.
* The root key is automatically generated by **SPIKE Nexus** and it's
  **never** stored on disk in plain text (*i.e., it always lives in memory*)
* An administrator (*through SPIKE Pilot*) provides a password to encrypt and
  backup the root key for emergency recovery. It is **crucial** to secure this
  password and not lose it.
* Key rotation will also re-encrypt secrets.

## Administrative Access

* Initial provisioning requires an admin to specify a password, which will also
  create an admin token in **SPIKE Nexus**.
* Admin uses the `spike login` command to exchange their password with a 
  temporary access token. This allows auditability and accountability.
* Once the system is initialized, accidental re-initialization is prevented.
  * For emergencies the admin user can use an out-of-band script to factory-reset
    **SPIKE**.

## Multi-Admin Support

* Initial admin can create other users an define policies for these users.
* Each admin can log in with their usernames and passwords and can have their 
  own valid temporary access tokens.

Benefits:
* Support for multiple administrators
* Give policy-based R/W access to various kinds of personas (i.e. an auditor
  can read but not write, an admin for a given tenant cannot see the secrets
  of a different tenant, etc.)
* Emergency access procedures
* Clear audit trail of admin access
